# 更新日志

## [v2.1.0] - 2025-01-09

### 新增功能
- **多Excel格式支持**：新增对矩阵格式Excel文件的支持（如3D-FREQ2.xlsx）
- **自动格式检测**：程序可自动识别传统格式和矩阵格式的Excel文件
- **完整球面数据**：支持360°×180°的完整球面天线方向图数据处理
- **增强数据解析**：改进的数据读取算法，支持更大规模的数据矩阵

### 改进功能
- **数据处理优化**：重构了AntennaDataReader类，提高了数据处理效率
- **角度转换**：自动处理弧度到角度的转换，兼容不同单位的输入数据
- **错误处理**：增强了文件读取的错误处理和调试信息输出
- **兼容性保持**：完全向后兼容原有的传统格式文件

### 技术改进
- 新增`_detect_file_format()`方法用于自动格式检测
- 新增`_process_matrix_format()`方法处理矩阵格式数据
- 重构`_process_legacy_format()`方法处理传统格式数据
- 改进Excel文件读取逻辑，支持多工作表文件

### 测试验证
- 添加了完整的测试脚本`test_new_format.py`
- 验证了两种格式文件的读取和绘图功能
- 确保了数据处理的准确性和稳定性

### 支持的文件格式
- **传统格式**：3D-FREQ.xlsx（Legacy Format）
- **矩阵格式**：3D-FREQ2.xlsx（Matrix Format）
- **CSV格式**：支持多种编码的CSV文件

---

## [v2.0.0] - 之前版本

### 基础功能
- 天线方向图2D/3D可视化
- Excel数据文件读取
- 多频率点支持
- 图像导出功能
- 交互式操作界面